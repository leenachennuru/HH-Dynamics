clc
clear all
delf1v = (V,m,n,h) (-120*m^3*h-36*n^4-3/10);
delf2v = (V,m,n,h) (-1/10/(exp(5/2-1/10*V)-1)*(1-m)+1/10*(5/2-1/10*V)/(exp(5/2-1/10*V)-1)^2*(1-m)*exp(5/2-1/10*V)+2/9*m*exp(-1/18*V));
delf3v = (V,m,n,h) (-7/2000*exp(-1/20*V)*(1-h)-1/10/(exp(3-1/10*V)+1)^2*h*exp(3-1/10*V));
delf4v = V,m,n,h) (-1/100/(exp(1-1/10*V)-1)*(1-n)+1/10*(1/10-1/100*V)/(exp(1-1/10*V)-1)^2*(1-n)*exp(1-1/10*V)+1/640*n*exp(-1/80*V));

delf1m = (@V,m,n,h) (-120*m^3*h-36*n^4-3/10);
delf2m = (@V,m,n,h) (-1/10/(exp(5/2-1/10*V)-1)*(1-m)+1/10*(5/2-1/10*V)/(exp(5/2-1/10*V)-1)^2*(1-m)*exp(5/2-1/10*V)+2/9*m*exp(-1/18*V));
delf3m = (@V,m,n,h) (-7/2000*exp(-1/20*V)*(1-h)-1/10/(exp(3-1/10*V)+1)^2*h*exp(3-1/10*V));
delf4m = (@V,m,n,h) (-1/100/(exp(1-1/10*V)-1)*(1-n)+1/10*(1/10-1/100*V)/(exp(1-1/10*V)-1)^2*(1-n)*exp(1-1/10*V)+1/640*n*exp(-1/80*V));

delf1h = (@V,m,n,h) (-120*m^3*h-36*n^4-3/10);
delf2h = (@V,m,n,h) (-1/10/(exp(5/2-1/10*V)-1)*(1-m)+1/10*(5/2-1/10*V)/(exp(5/2-1/10*V)-1)^2*(1-m)*exp(5/2-1/10*V)+2/9*m*exp(-1/18*V));
delf3h = (@V,m,n,h) (-7/2000*exp(-1/20*V)*(1-h)-1/10/(exp(3-1/10*V)+1)^2*h*exp(3-1/10*V));
delf4h = (@V,m,n,h) (-1/100/(exp(1-1/10*V)-1)*(1-n)+1/10*(1/10-1/100*V)/(exp(1-1/10*V)-1)^2*(1-n)*exp(1-1/10*V)+1/640*n*exp(-1/80*V));

delf1n = (@V,m,n,h) (-120*m^3*h-36*n^4-3/10);
delf2n = (@V,m,n,h) (-1/10/(exp(5/2-1/10*V)-1)*(1-m)+1/10*(5/2-1/10*V)/(exp(5/2-1/10*V)-1)^2*(1-m)*exp(5/2-1/10*V)+2/9*m*exp(-1/18*V));
delf3n = (@V,m,n,h) (-7/2000*exp(-1/20*V)*(1-h)-1/10/(exp(3-1/10*V)+1)^2*h*exp(3-1/10*V));
delf4n = (@V,m,n,h) (-1/100/(exp(1-1/10*V)-1)*(1-n)+1/10*(1/10-1/100*V)/(exp(1-1/10*V)-1)^2*(1-n)*exp(1-1/10*V)+1/640*n*exp(-1/80*V));
 
%V  = 18.46;   
%m  = 0.3304; 
%h  = 0.1038;  %correspond to current = 100
%n  = 0.5995;


V = 31.3;
m = 0.6563;       %correspond to Iext = 400 
h = 0.02664;
n = 0.741; 

Jacmat = [delf1v delf1m delf1h delf1n; delf2v delf2m delf2h delf2n; delf3v delf3m delf3h delf3n; delf4v delf4m delf4h delf4n;];
eigv = eig(Jacmat)