KV1 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - 2V1 + V2+ V3-((GNa*(m1^3)*h1*(V1-VNa))+(GK*(n1^4)*(V1-VK))+(GL*(V1-VL))))/c);
km1 = @(V1,m1)  ((((0.1*(25-V1))/(exp((25-V1)/10) - 1))*(1 - m1)) - (m1*(4*exp(-V1/18))));
kh1 = @(V1,h1)  ((0.07*exp(-V1/20))*(1-h1)) - ((1/(exp((30-V1)/10) + 1))*h1);
kn1 = @(V1,n1)  ((0.01*(10-V1)/(exp((10-V1)/10) - 1))*(1-n1) -n1*(0.125*exp(-V1/80)));

KV2 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - ((GNa*( m1^3 )* h1 *( V1-VNa )) + (GK*( n1^4 )*( V1-VK ))+(GL*( V1-VL ))))/c);
km2 = @(V2,m2)  ((((0.1*(25-V2))/(exp((25-V2)/10) - 1))*(1 - m2)) - (m2*(4*exp(-V2/18))));
kh2 = @(V2,h2)  ((0.07*exp(-V2/20))*(1-h2)) - ((1/(exp((30-V2)/10) + 1))*h2);
kn2 = @(V2,n2)  ((0.01*(10-V2)/(exp((10-V2)/10) - 1))*(1-n2) -n2*(0.125*exp(-V2/80)));

KV3 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - ((GNa*( m1^3 )* h1 *( V1-VNa )) + (GK*( n1^4 )*( V1-VK ))+(GL*( V1-VL ))))/c);
km3 = @(V3,m3)  ((((0.1*(25-V3))/(exp((25-V3)/10) - 1))*(1 - m3)) - (m3*(4*exp(-V3/18))));
kh3 = @(V3,h3)  ((0.07*exp(-V3/20))*(1-h3)) - ((1/(exp((30-V3)/10) + 1))*h3);
kn3 = @(V3,n3)  ((0.01*(10-V3)/(exp((10-V3)/10) - 1))*(1-n3) -n3*(0.125*exp(-V3/80)));

KV4 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - ((GNa*( m1^3 )* h1 *( V1-VNa )) + (GK*( n1^4 )*( V1-VK ))+(GL*( V1-VL ))))/c);
km4 = @(V4,m4)  ((((0.1*(25-V4))/(exp((25-V4)/10) - 1))*(1 - m4)) - (m4*(4*exp(-V4/18))));
kh4 = @(V4,h4)  ((0.07*exp(-V4/20))*(1-h4)) - ((1/(exp((30-V4)/10) + 1))*h4);
kn4 = @(V4,n4)  ((0.01*(10-V4)/(exp((10-V4)/10) - 1))*(1-n4) -n4*(0.125*exp(-V4/80)));

KV5 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - ((GNa*( m1^3 )* h1 *( V1-VNa )) + (GK*( n1^4 )*( V1-VK ))+(GL*( V1-VL ))))/c);
km5 = @(V,m1)  ((((0.1*(25-V1))/(exp((25-V1)/10) - 1))*(1 - m1)) - (m1*(4*exp(-V1/18))));
kh5 = @(V1,h1)  ((0.07*exp(-V1/20))*(1-h1)) - ((1/(exp((30-V1)/10) + 1))*h1);
kn5 = @(V1,n1)  ((0.01*(10-V1)/(exp((10-V1)/10) - 1))*(1-n1) -n1*(0.125*exp(-V1/80)));

KV6 = @(I,V1,V2,V3,V4,V5,V6,m1,m2,m3,m4,m5,m6,h1,h2,h3,h4,h5,h6,n1,n2,n3,n4,n5,n6,GNa,GK,GL,VNa,VK,VL,c) ((I - ((GNa*( m1^3 )* h1 *( V1-VNa )) + (GK*( n1^4 )*( V1-VK ))+(GL*( V1-VL ))))/c);
km6 = @(V6,m6)  ((((0.1*(25-V6))/(exp((25-V6)/10) - 1))*(1 - m6)) - (m6*(4*exp(-V6/18))));
kh6 = @(V6,h6)  ((0.07*exp(-V6/20))*(1-h6)) - ((1/(exp((30-V6)/10) + 1))*h6);
kn6 = @(V6,n6)  ((0.01*(10-V6)/(exp((10-V6)/10) - 1))*(1-n6) -n6*(0.125*exp(-V6/80)));